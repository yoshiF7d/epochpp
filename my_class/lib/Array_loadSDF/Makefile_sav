COMPILER = gcc
CFLAGS = -O3
LIBS =
TARGET = ./bin/readsdf
LIBTARGET = ./lib/libArray_loadSDF.a
LDFLAGS =

OBJDIR = ./obj
SRCDIR = ./src

SRCNAMES = readsdf.c utilities.c LinkedList.c Array.c Array_loadSDF.c sdf_input_cartesian.c sdf_input_point.c sdf_control.c sdf_input_station.c sdf_input.c sdf_util.c
SRCS = $(addprefix $(SRCDIR)/, $(SRCNAMES))
OBJS = $(addprefix $(OBJDIR)/, $(SRCNAMES:.c=.o))
SRCS2 = $(addprefix $(SRCDIR)/, $(SRCNAMES2))
OBJS2 = $(addprefix $(OBJDIR)/, $(SRCNAMES2:.c=.o))

$(TARGET) : $(OBJS)
	$(COMPILER) $(CFLAGS) -o $@ $^ $(LDFLAGS)

$(TARGET2) : $(OBJS2)
	$(COMPILER) $(CFLAGS) -o $@ $^ $(LDFLAGS)

$(OBJDIR)/%.o: $(SRCDIR)/%.c
	$(COMPILER) $(CFLAGS) -o $@ -c $<

lib : $(OBJS) 
	ar rcs $(LIBTARGET) $(OBJDIR)/Array_loadSDF.o $(OBJDIR)/sdf_control.o $(OBJDIR)/sdf_input_cartesian.o $(OBJDIR)/sdf_input_point.o $(OBJDIR)/sdf_input_station.o $(OBJDIR)/sdf_input.o $(OBJDIR)/sdf_util.o
$(OBJDIR)/utilities.o : $(SRCDIR)/utilities.h
$(OBJDIR)/Array.o : $(SRCDIR)/Array.h
$(OBJDIR)/Array_loadSDF.o : $(SRCDIR)/Array_loadSDF.h
$(OBJDIR)/sdf_input_cartesian.o : $(SRCDIR)/sdf.h
$(OBJDIR)/sdf_input_point.o : $(SRCDIR)/sdf.h


.PHONY : clean lib
clean :
	rm -f $(OBJDIR)/*.o
	rm -f $(TARGET)
	rm -f $(TARGET2)
